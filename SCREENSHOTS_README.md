# 📱 App Store Screenshots with XCUITest

BabyStepsアプリのApp Store Connect審査用スクリーンショットを、XCUITestを使用して自動生成するワークフローです。

## 🎯 必要なスクリーンショット

App Store Connectの審査では、以下のデバイスサイズのスクリーンショットが必要です：

- **📱 iPhone (6.5 inch)**: iPhone 16 Pro Max (iOS 18.6)
- **📱 iPad (13 inch)**: iPad Pro (13-inch) (6th generation) (iOS 18.6)

## 🚀 ワークフローの実行方法

### 1. 手動実行（Manual Trigger）

1. GitHubリポジトリの **Actions** タブに移動
2. **UI Test Screenshots** ワークフローを選択
3. **Run workflow** ボタンをクリック
4. デバイスタイプを選択：
   - `both`: iPhoneとiPad両方のスクリーンショットを生成
   - `iphone`: iPhoneのみ
   - `ipad`: iPadのみ
5. **Run workflow** をクリックして実行開始

### 2. 自動実行（PR作成時）

- `main` または `develop` ブランチへのPRを作成すると自動実行
- PRの作成、更新、再オープン時に実行
- 手動実行と同じ品質でスクリーンショットを生成

## 📸 生成されるスクリーンショット

各デバイスで以下の画面が撮影されます：

1. **01-main-screen.png** - メイン画面（タスク一覧と全体進捗）
2. **02-task-list.png** - タスクリスト表示
3. **03-add-task.png** - 新しいタスク追加画面
4. **04-task-detail.png** - タスク詳細とステップ一覧
5. **05-progress-view.png** - 進捗率の視覚的表示

## 📥 スクリーンショットの確認・ダウンロード方法

### 方法1: GitHub Actionsの実行結果から

1. **Actions** タブに移動
2. **UI Test Screenshots** ワークフローを選択
3. 実行されたワークフロー（例：`#123`）をクリック
4. 実行結果ページで **Artifacts** セクションを確認
5. `ui-test-screenshots-123` をダウンロード
6. ZIPファイルを解凍してスクリーンショットを確認

### 方法2: PRのチェック結果から

1. PRのページで **Checks** タブを確認
2. **UI Test Screenshots** の実行結果をクリック
3. **Artifacts** セクションからスクリーンショットをダウンロード

### 方法3: ワークフロー実行後のサマリーから

1. ワークフロー実行完了後、実行結果ページの上部に表示されるサマリーを確認
2. **📥 Download screenshots:** セクションの手順に従ってダウンロード

## 🔍 スクリーンショットの確認ポイント

### 品質チェック項目

- **✅ 画面が正しく表示されているか**
- **✅ テキストが読みやすいか**
- **✅ UI要素が適切に配置されているか**
- **✅ アプリの状態が意図したものか**
- **✅ スクリーンショットの解像度が適切か**

### 各画面の確認内容

#### 01-main-screen.png
- タスク一覧が表示されている
- 全体進捗バーが表示されている
- 追加ボタンが適切に配置されている

#### 02-task-list.png
- タスクのタイトルが表示されている
- 進捗率が表示されている
- リストのレイアウトが適切

#### 03-add-task.png
- 入力フィールドが表示されている
- 保存・キャンセルボタンが配置されている
- モーダルの表示が適切

#### 04-task-detail.png
- タスクの詳細情報が表示されている
- ステップ一覧が表示されている
- 各ステップの完了状態が表示されている

#### 05-progress-view.png
- 進捗率が視覚的に表示されている
- グラフやバーが適切に描画されている
- 数値が正確に表示されている

## 🛠️ トラブルシューティング

### よくある問題と解決方法

#### 1. スクリーンショットが生成されない

**原因**: UIテストが失敗している
**解決方法**:
- ワークフローの実行ログを確認
- テストエラーの詳細を確認
- アプリのUI要素の識別子を確認

#### 2. スクリーンショットが空または不完全

**原因**: アプリの起動が完了していない
**解決方法**:
- テスト内の待機時間を延長
- アプリの起動状態を確認
- シミュレーターの状態を確認

#### 3. 特定の画面が撮影されない

**原因**: UI要素の識別子が変更されている
**解決方法**:
- `Tests/BabyStepsUITests/ScreenshotUITests.swift` の要素識別子を確認
- アプリのUI要素に適切なアクセシビリティ識別子を設定

### ログの確認方法

1. ワークフロー実行結果ページで **Run UI Tests for iPhone/iPad** ステップを展開
2. 実行ログを確認してエラーメッセージを特定
3. 必要に応じてテストコードを修正

## 📋 App Store Connectでの使用方法

1. **App Store Connect** にログイン
2. **BabySteps** アプリを選択
3. **App Store** → **スクリーンショット** セクション
4. 各デバイスサイズに適切なスクリーンショットをアップロード：
   - iPhone (6.5 inch): `screenshots/iphone/` 内の画像
   - iPad (13 inch): `screenshots/ipad/` 内の画像

## 🎨 スクリーンショットの最適化

### 品質向上のポイント

- **高解像度**: シミュレーターの設定で高解像度を選択
- **一貫性**: 同じアプリ状態で撮影
- **可読性**: テキストとUI要素が明確に表示
- **魅力的**: アプリの主要機能を効果的にアピール

### カスタマイズ方法

`Tests/BabyStepsUITests/ScreenshotUITests.swift` を編集して：

- スクリーンショットの撮影タイミングを調整
- 追加の画面を撮影
- サンプルデータの内容を変更
- 待機時間を調整

## 📞 サポート

スクリーンショット生成で問題が発生した場合：

1. GitHub Actionsの実行ログを確認
2. エラーメッセージを確認
3. 必要に応じてテストコードを修正
4. ワークフローを再実行

---

**注意**: このワークフローは、App Store Connectの審査要件を満たす高品質なスクリーンショットを生成することを目的としています。生成されたスクリーンショットは、アプリの実際の機能と一致していることを確認してください。